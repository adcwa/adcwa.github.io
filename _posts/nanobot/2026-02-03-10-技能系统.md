# ç¬¬äº”å±‚ï¼šæŠ€èƒ½ç³»ç»Ÿ

> ğŸ“Œ **æ ¸å¿ƒæ–‡ä»¶**ï¼š`nanobot/agent/skills.py` (~229 è¡Œ)  
> **æŠ€èƒ½ç›®å½•**ï¼š`~/.nanobot/skills/` å’Œ `nanobot/skills/`

## æ¦‚è¿°

æŠ€èƒ½ï¼ˆSkillï¼‰æ˜¯ nanobot çš„ä¸€ç§ç‰¹æ®Šæ‰©å±•æœºåˆ¶ï¼Œä¸å·¥å…·ï¼ˆToolï¼‰äº’è¡¥ï¼š

| å¯¹æ¯”ç»´åº¦ | å·¥å…·ï¼ˆToolï¼‰ | æŠ€èƒ½ï¼ˆSkillï¼‰ |
|---------|------------|-------------|
| **å½¢å¼** | Python ä»£ç  | Markdown æ–‡æ¡£ + å¯é€‰è„šæœ¬ |
| **è°ƒç”¨æ–¹å¼** | LLM ç›´æ¥è°ƒç”¨ | LLM è¯»å–åç†è§£ä½¿ç”¨ |
| **çµæ´»æ€§** | å›ºå®šå‚æ•° | è‡ªç”±æ–‡æœ¬æŒ‡ä»¤ |
| **å¼€å‘éš¾åº¦** | éœ€è¦ç¼–ç¨‹ | åªéœ€å†™æ–‡æ¡£ |
| **é€‚ç”¨åœºæ™¯** | æ˜ç¡®çš„APIè°ƒç”¨ | éœ€è¦ä¸Šä¸‹æ–‡ç†è§£çš„ä»»åŠ¡ |

## æŠ€èƒ½çš„å·¥ä½œåŸç†

```mermaid
sequenceDiagram
    participant User
    participant Agent
    participant LLM
    participant SkillsLoader

    User->>Agent: "ä½¿ç”¨ GitHub æŠ€èƒ½æŸ¥è¯¢ä»“åº“"
    SkillsLoader->>Agent: åŠ è½½æŠ€èƒ½æ‘˜è¦åˆ°ç³»ç»Ÿæç¤º
    Note over Agent: ç³»ç»Ÿæç¤ºåŒ…å«ï¼š<br/>- skill: github<br/>- location: ~/.nanobot/skills/github/SKILL.md
    Agent->>LLM: å‘é€æ¶ˆæ¯ + ç³»ç»Ÿæç¤º
    LLM->>Agent: è°ƒç”¨ read_file è¯»å– SKILL.md
    Agent->>SkillsLoader: è¯»å–å®Œæ•´æŠ€èƒ½æ–‡æ¡£
    SkillsLoader->>Agent: è¿”å›æŠ€èƒ½å†…å®¹
    Agent->>LLM: æä¾›æŠ€èƒ½å†…å®¹
    LLM->>Agent: ç†è§£åç”Ÿæˆå‘½ä»¤æˆ–æ“ä½œ
    Note over LLM: ä¾‹å¦‚ï¼šexec("gh repo view HKUDS/nanobot")
```

**å…³é”®å·®å¼‚**ï¼š
- å·¥å…·ï¼šLLM ç›´æ¥è°ƒç”¨ `execute()` æ–¹æ³•
- æŠ€èƒ½ï¼šLLM å…ˆè¯»å–æ–‡æ¡£ï¼Œç†è§£åè‡ªå·±å†³å®šå¦‚ä½•ä½¿ç”¨

## æŠ€èƒ½æ–‡ä»¶ç»“æ„

### æ ‡å‡†ç›®å½•ç»“æ„

```
~/.nanobot/skills/my-skill/
â”œâ”€â”€ SKILL.md          # æŠ€èƒ½å®šä¹‰ï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ script.py         # å¯é€‰çš„è¾…åŠ©è„šæœ¬
â”œâ”€â”€ config.json       # å¯é€‰çš„é…ç½®æ–‡ä»¶
â””â”€â”€ resources/        # å¯é€‰çš„èµ„æºæ–‡ä»¶
    â””â”€â”€ template.txt
```

### SKILL.md æ ¼å¼

```markdown
---
name: my-skill
description: æŠ€èƒ½çš„ç®€çŸ­æè¿°ï¼ˆæ˜¾ç¤ºåœ¨æ‘˜è¦ä¸­ï¼‰
available: true
---

# my-skill

å®Œæ•´çš„æŠ€èƒ½ä½¿ç”¨è¯´æ˜ã€‚

## ç”¨é€”

è¿™ä¸ªæŠ€èƒ½ç”¨äº...

## å‰ç½®è¦æ±‚

- å®‰è£… `some-cli-tool`
- è®¾ç½®ç¯å¢ƒå˜é‡ `API_KEY`

## ä½¿ç”¨æ–¹æ³•

\```bash
some-cli-tool command --arg value
\```

## ç¤ºä¾‹

å½“ç”¨æˆ·è¯´ "åšæŸæŸäº‹" æ—¶ï¼Œæ‰§è¡Œï¼š
\```bash
some-cli-tool do-something
\```

## æ³¨æ„äº‹é¡¹

- ç¡®ä¿å…ˆ...
- é¿å…...
```

### Frontmatter å…ƒæ•°æ®

```yaml
---
name: github              # æŠ€èƒ½åç§°ï¼ˆå¿…éœ€ï¼‰
description: GitHub ops   # ç®€çŸ­æè¿°
available: true           # æ˜¯å¦å¯ç”¨
always: false             # æ˜¯å¦å§‹ç»ˆåŠ è½½ï¼ˆé»˜è®¤ falseï¼‰
metadata: |               # nanobot ä¸“æœ‰å…ƒæ•°æ®ï¼ˆJSONï¼‰
  {
    "nanobot": {
      "requires": {
        "bins": ["gh"],         # éœ€è¦çš„å‘½ä»¤è¡Œå·¥å…·
        "env": ["GITHUB_TOKEN"] # éœ€è¦çš„ç¯å¢ƒå˜é‡
      },
      "always": false           # ä¼˜å…ˆçº§é«˜äºå¤–å±‚
    }
  }
---
```

## SkillsLoader æ ¸å¿ƒç±»

### åˆå§‹åŒ–

```python
class SkillsLoader:
    def __init__(self, workspace: Path, builtin_skills_dir: Path | None = None):
        self.workspace = workspace
        self.workspace_skills = workspace / "skills"     # ç”¨æˆ·æŠ€èƒ½
        self.builtin_skills = builtin_skills_dir         # å†…ç½®æŠ€èƒ½
```

**æŠ€èƒ½ä¼˜å…ˆçº§**ï¼š
1. ç”¨æˆ·æŠ€èƒ½ï¼ˆ`~/.nanobot/skills/`ï¼‰
2. å†…ç½®æŠ€èƒ½ï¼ˆ`nanobot/skills/`ï¼‰

å¦‚æœåŒåï¼Œç”¨æˆ·æŠ€èƒ½è¦†ç›–å†…ç½®æŠ€èƒ½ã€‚

### æ ¸å¿ƒæ–¹æ³•

#### list_skills() - åˆ—å‡ºæŠ€èƒ½

```python
def list_skills(self, filter_unavailable: bool = True) -> list[dict]:
    """
    åˆ—å‡ºæ‰€æœ‰æŠ€èƒ½
    
    Returns:
        [
            {"name": "github", "path": "...", "source": "workspace"},
            {"name": "weather", "path": "...", "source": "builtin"}
        ]
    """
```

**è¿‡æ»¤é€»è¾‘**ï¼š
- æ£€æŸ¥ `requires.bins` ä¸­çš„å‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼ˆ`shutil.which`ï¼‰
- æ£€æŸ¥ `requires.env` ä¸­çš„ç¯å¢ƒå˜é‡æ˜¯å¦è®¾ç½®

#### load_skill() - åŠ è½½å•ä¸ªæŠ€èƒ½

```python
def load_skill(self, name: str) -> str | None:
    """åŠ è½½æŠ€èƒ½å†…å®¹ï¼Œè¿”å›å®Œæ•´çš„ SKILL.md"""
```

#### build_skills_summary() - æ„å»ºæ‘˜è¦

```python
def build_skills_summary(self) -> str:
    """
    ç”Ÿæˆ XML æ ¼å¼çš„æŠ€èƒ½æ‘˜è¦ï¼Œæ·»åŠ åˆ°ç³»ç»Ÿæç¤º
    
    Returns:
        <skills>
          <skill available="true">
            <name>github</name>
            <description>GitHub operations</description>
            <location>~/.nanobot/skills/github/SKILL.md</location>
          </skill>
          <skill available="false">
            <name>aws</name>
            <description>AWS operations</description>
            <location>~/.nanobot/skills/aws/SKILL.md</location>
            <requires>CLI: aws, ENV: AWS_ACCESS_KEY</requires>
          </skill>
        </skills>
    """
```

**ä¸ºä»€ä¹ˆç”¨ XMLï¼Ÿ**
- ç»“æ„åŒ–ï¼ŒLLM å®¹æ˜“è§£æ
- ç´§å‡‘ï¼ŒèŠ‚çœ token
- æ”¯æŒå±æ€§ï¼ˆ`available`ï¼‰

#### get_always_skills() - å§‹ç»ˆåŠ è½½çš„æŠ€èƒ½

```python
def get_always_skills(self) -> list[str]:
    """
    è¿”å› always=true ä¸”å¯ç”¨çš„æŠ€èƒ½åˆ—è¡¨
    è¿™äº›æŠ€èƒ½çš„å®Œæ•´å†…å®¹ä¼šç›´æ¥åŠ è½½åˆ°ç³»ç»Ÿæç¤º
    """
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- å¸¸ç”¨æŠ€èƒ½ï¼ˆå¦‚ `github`ï¼‰
- åŸºç¡€æŠ€èƒ½ï¼ˆå¦‚ `skill-creator`ï¼‰

**æ³¨æ„**ï¼š
- ä¼šå¢åŠ ç³»ç»Ÿæç¤ºé•¿åº¦
- åªæ ‡è®°æœ€é‡è¦çš„æŠ€èƒ½

## å†…ç½®æŠ€èƒ½è¯¦è§£

### 1. github - GitHub æ“ä½œ

**ä½ç½®**ï¼š`nanobot/skills/github/SKILL.md`

**åŠŸèƒ½**ï¼š
- æŸ¥çœ‹ä»“åº“ä¿¡æ¯
- åˆ—å‡º issues
- åˆ›å»º issue
- PR æ“ä½œ
- ...

**å‰ç½®è¦æ±‚**ï¼š
```bash
# å®‰è£… GitHub CLI
brew install gh

# ç™»å½•
gh auth login
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

ç”¨æˆ·ï¼š**"æŸ¥çœ‹ HKUDS/nanobot ä»“åº“çš„æœ€æ–° issues"**

LLM ç†è§£æŠ€èƒ½åæ‰§è¡Œï¼š
```bash
gh issue list --repo HKUDS/nanobot --limit 10
```

### 2. weather - å¤©æ°”æŸ¥è¯¢

**åŠŸèƒ½**ï¼šæŸ¥è¯¢æŒ‡å®šåŸå¸‚çš„å¤©æ°”

**å‰ç½®è¦æ±‚**ï¼š
- å¤©æ°” API Keyï¼ˆå¦‚ OpenWeatherï¼‰
- ç¯å¢ƒå˜é‡ `WEATHER_API_KEY`

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

ç”¨æˆ·ï¼š**"åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"**

LLM æŸ¥çœ‹æŠ€èƒ½åè°ƒç”¨è„šæœ¬ï¼š
```bash
python ~/.nanobot/skills/weather/fetch.py --city Beijing
```

### 3. tmux - Tmux ä¼šè¯ç®¡ç†

**åŠŸèƒ½**ï¼š
- åˆ›å»º/è¿æ¥ tmux ä¼šè¯
- åˆ—å‡ºæ´»åŠ¨ä¼šè¯
- å‘é€å‘½ä»¤åˆ°ä¼šè¯

**å‰ç½®è¦æ±‚**ï¼š
```bash
brew install tmux
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- å¯åŠ¨é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡
- ç®¡ç†å¤šä¸ªå¼€å‘ç¯å¢ƒ

### 4. summarize - å†…å®¹æ‘˜è¦

**åŠŸèƒ½**ï¼šæ€»ç»“é•¿æ–‡æœ¬æˆ–ç½‘é¡µ

**å®ç°**ï¼š
- ä½¿ç”¨ `read_file` è·å–å†…å®¹
- ä½¿ç”¨ LLM è‡ªèº«èƒ½åŠ›ç”Ÿæˆæ‘˜è¦

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

ç”¨æˆ·ï¼š**"æ€»ç»“è¿™ç¯‡é•¿æ–‡ç« "**

LLMï¼š
1. è¯»å–æ–‡ç« å†…å®¹
2. æŸ¥çœ‹ summarize æŠ€èƒ½çš„å»ºè®®
3. ç”Ÿæˆç»“æ„åŒ–æ‘˜è¦

### 5. skill-creator - æŠ€èƒ½åˆ›å»ºåŠ©æ‰‹

**åŠŸèƒ½**ï¼šå¸®åŠ©ç”¨æˆ·åˆ›å»ºæ–°æŠ€èƒ½

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

ç”¨æˆ·ï¼š**"åˆ›å»ºä¸€ä¸ª Docker æŠ€èƒ½"**

LLM ä¼šï¼š
1. åˆ›å»ºç›®å½• `~/.nanobot/skills/docker/`
2. ç”Ÿæˆ `SKILL.md` æ¨¡æ¿
3. è¯¢é—®ç”¨æˆ·éœ€è¦çš„å…·ä½“åŠŸèƒ½

## æŠ€èƒ½çš„ä¸Šä¸‹æ–‡é›†æˆ

### ä¸¤ç§åŠ è½½æ¨¡å¼

```python
# åœ¨ ContextBuilder ä¸­

# æ¨¡å¼ 1ï¼šå§‹ç»ˆåŠ è½½ï¼ˆå®Œæ•´å†…å®¹ï¼‰
always_skills = self.skills.get_always_skills()  # ["github"]
if always_skills:
    content = self.skills.load_skills_for_context(always_skills)
    system_prompt += f"\n\n# Active Skills\n\n{content}"

# æ¨¡å¼ 2ï¼šæŒ‰éœ€åŠ è½½ï¼ˆä»…æ‘˜è¦ï¼‰
summary = self.skills.build_skills_summary()
if summary:
    system_prompt += f"\n\n# Available Skills\n\n{summary}"
```

### LLM å¦‚ä½•ä½¿ç”¨æŠ€èƒ½

```
ç”¨æˆ·æ¶ˆæ¯ï¼š"æŸ¥çœ‹ nanobot ä»“åº“"

ç³»ç»Ÿæç¤ºåŒ…å«ï¼š
  <skill available="true">
    <name>github</name>
    <location>~/.nanobot/skills/github/SKILL.md</location>
  </skill>

LLM æ€è€ƒï¼š
  "æˆ‘éœ€è¦æŸ¥çœ‹ GitHub ä»“åº“ï¼Œæœ‰ github æŠ€èƒ½å¯ç”¨"

LLM è¡ŒåŠ¨ 1ï¼š
  read_file(path="~/.nanobot/skills/github/SKILL.md")

è¿”å›ï¼š
  """
  # GitHub Skill
  
  ä½¿ç”¨ GitHub CLI (gh) æ“ä½œä»“åº“ã€‚
  
  æŸ¥çœ‹ä»“åº“ï¼š
  gh repo view OWNER/REPO
  """

LLM è¡ŒåŠ¨ 2ï¼š
  exec(command="gh repo view HKUDS/nanobot")

è¿”å›ï¼š
  [ä»“åº“ä¿¡æ¯]

LLM å“åº”ï¼š
  "è¿™æ˜¯ nanobot ä»“åº“çš„ä¿¡æ¯ï¼š..."
```

##åˆ›å»ºè‡ªå®šä¹‰æŠ€èƒ½

### å¿«é€Ÿå¼€å§‹

```bash
# 1. åˆ›å»ºæŠ€èƒ½ç›®å½•
mkdir -p ~/.nanobot/skills/my-skill

# 2. åˆ›å»º SKILL.md
cat > ~/.nanobot/skills/my-skill/SKILL.md << 'EOF'
---
name: my-skill
description: æˆ‘çš„è‡ªå®šä¹‰æŠ€èƒ½
available: true
---

# my-skill

è¿™ä¸ªæŠ€èƒ½ç”¨äº...

## ä½¿ç”¨æ–¹æ³•

\```bash
echo "Hello from my skill!"
\```
EOF

# 3. æµ‹è¯•
nanobot agent -m "ä½¿ç”¨ my-skill æŠ€èƒ½"
```

### å¸¦è„šæœ¬çš„æŠ€èƒ½

```python
# ~/.nanobot/skills/my-skill/script.py

#!/usr/bin/env python3
import sys
import json

def main():
    if len(sys.argv) < 2:
        print("Usage: script.py <arg>", file=sys.stderr)
        sys.exit(1)
    
    arg = sys.argv[1]
    
    # å¤„ç†é€»è¾‘
    result = {"status": "success", "data": f"Processed: {arg}"}
    
    # è¾“å‡º JSON
    print(json.dumps(result))

if __name__ == "__main__":
    main()
```

åœ¨ SKILL.md ä¸­è¯´æ˜å¦‚ä½•è°ƒç”¨ï¼š

```markdown
## ä½¿ç”¨æ–¹æ³•

\```bash
python ~/.nanobot/skills/my-skill/script.py "input"
\```
```

## æœ€ä½³å®è·µ

### 1. æ¸…æ™°çš„æ–‡æ¡£

```markdown
# âœ… å¥½çš„ç¤ºä¾‹

## ä½¿ç”¨æ–¹æ³•

æŸ¥è¯¢å¤©æ°”ï¼š
\```bash
curl "https://api.weather.com/v1/current?city=Beijing&key=$API_KEY"
\```

## âŒ ä¸å¥½çš„ç¤ºä¾‹

ä½¿ç”¨ weather API è·å–æ•°æ®
```

### 2. å…·ä½“çš„ç¤ºä¾‹

```markdown
# âœ… å¥½

## ç¤ºä¾‹

å½“ç”¨æˆ·è¯´ "åŒ—äº¬å¤©æ°”"ï¼š
\```bash
python script.py --city Beijing
\```

è¾“å‡ºï¼š
\```
Temperature: 15Â°C
Condition: Sunny
\```
```

### 3. é”™è¯¯å¤„ç†è¯´æ˜

```markdown
## å¸¸è§é—®é¢˜

**Q: æç¤º "API key not found"**
A: è®¾ç½®ç¯å¢ƒå˜é‡ï¼š`export WEATHER_API_KEY=xxx`

**Q: è¶…æ—¶**
A: æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œæˆ–å¢åŠ è¶…æ—¶æ—¶é—´ï¼š`--timeout 30`
```

## æŠ€èƒ½ vs å·¥å…·çš„é€‰æ‹©

```python
# ä½¿ç”¨å·¥å…·çš„åœºæ™¯
âœ… å›ºå®šçš„ API è°ƒç”¨ï¼ˆå¦‚è¯»æ–‡ä»¶ã€æ‰§è¡Œå‘½ä»¤ï¼‰
âœ… éœ€è¦ Python ç‰¹å®šåº“ï¼ˆå¦‚ httpxã€Pydanticï¼‰
âœ… å¤æ‚çš„æ•°æ®å¤„ç†é€»è¾‘

# ä½¿ç”¨æŠ€èƒ½çš„åœºæ™¯
âœ… ä½¿ç”¨ç°æœ‰ CLI å·¥å…·ï¼ˆå¦‚ ghã€awsã€kubectlï¼‰
âœ… éœ€è¦ä¸Šä¸‹æ–‡ç†è§£çš„ä»»åŠ¡
âœ… å¿«é€Ÿæ·»åŠ æ–°åŠŸèƒ½ï¼ˆæ— éœ€ç¼–ç¨‹ï¼‰
âœ… ç¤¾åŒºè´¡çŒ®ï¼ˆåªéœ€å†™æ–‡æ¡£ï¼‰
```

## å°ç»“

- âœ… æŠ€èƒ½æ˜¯ Markdown æ–‡æ¡£ï¼Œæ˜“äºåˆ›å»ºå’Œåˆ†äº«
- âœ… é€šè¿‡ç³»ç»Ÿæç¤ºé›†æˆï¼ŒLLM æŒ‰éœ€è¯»å–
- âœ… æ”¯æŒæ¸è¿›å¼åŠ è½½ï¼ˆæ‘˜è¦ â†’ å®Œæ•´å†…å®¹ï¼‰
- âœ… è‡ªåŠ¨æ£€æµ‹ä¾èµ–ï¼ˆbinsã€envï¼‰
- âœ… ä¸å·¥å…·äº’è¡¥ï¼Œå„æœ‰ä¼˜åŠ¿

**ä¸‹ä¸€æ­¥**ï¼š[11-å­ä»£ç†ç³»ç»Ÿ.md](./nanobot/2026-02-03/11-å­ä»£ç†ç³»ç»Ÿ.md) - äº†è§£åå°ä»»åŠ¡å¤„ç†ã€‚
